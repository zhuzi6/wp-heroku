(self.webpackChunksakurairo_scripts=self.webpackChunksakurairo_scripts||[]).push([[48],{3048:(t,e,r)=>{r.r(e),r.d(e,{default:()=>m});var i=class{constructor(t){this.key=t,this.pull()}pull(){let t=window.history.state,e=null==t?void 0:t[this.key];if(void 0===e||this.index!==e){var r=window.sessionStorage.getItem(this.key),i=r?JSON.parse(r):[];i[this.index]=this.state,window.sessionStorage.setItem(this.key,JSON.stringify(i)),void 0===e?(this.index=i.length,this.state=null,window.history.replaceState({...t,[this.key]:this.index},document.title)):(this.index=e,this.state=r?i[e]:null)}}};let s=(t,e)=>{t.replaceWith(e)};var o={default:s,innerHTML:(t,e)=>{t.innerHTML=e.innerHTML},textContent:(t,e)=>{t.textContent=e.textContent},innerText:(t,e)=>{t.innerText=e.innerText},attributes:(t,e)=>{let r=t.getAttributeNames();e.getAttributeNames().forEach((i=>{t.setAttribute(i,e.getAttribute(i)||""),r=r.filter((t=>t!==i))})),r.forEach((e=>{t.removeAttribute(e)}))},replaceWith:s};var n=class{constructor(t,e){this.form=t,this.submitterButton=e===t?null:e}getAttribute(t){let{submitterButton:e,form:r}=this;if(e&&e.hasAttribute(`form${t}`)){var i=`${t.charAt(0).toUpperCase()}${t.slice(1)}`;if(i=e[`form${i}`])return i}return r[t]}getNameValuePairs(){return Array.from(new FormData(this.form),(([t,e])=>[t,e instanceof File?e.name:e]))}getURLSearchParams(){return new URLSearchParams(this.getNameValuePairs())}getTextPlain(){return this.getNameValuePairs().reduce(((t,[e,r])=>`${t}${e}=${r}\r\n`),"")}getRequestInfo(){let t=this.getAttribute("action");var e=new URL(t,document.URL);if(!/^https?:$/.test(e.protocol))return null;switch(this.getAttribute("method")){case"get":return e.search=this.getURLSearchParams().toString(),e.href;case"post":switch(this.getAttribute("enctype")){case"application/x-www-form-urlencoded":e=this.getURLSearchParams();break;case"multipart/form-data":e=new FormData(this.form);break;case"text/plain":e=this.getTextPlain();break;default:return null}return new Request(t,{method:"POST",body:e});default:return null}}};let a=t=>{if(t===window.name)return window;switch(t.toLowerCase()){case"":case"_self":return window;case"_parent":return window.parent;case"_top":return window.top}};class l{constructor(t){this.pjax=t}onLinkOpen(t){if(!t.defaultPrevented){var{target:e}=t;if(e instanceof Element&&(e=e.closest("a[href], area[href]"))){if((t instanceof MouseEvent||t instanceof KeyboardEvent)&&(t.metaKey||t.ctrlKey||t.shiftKey||t.altKey))return;a(e.target)===window&&e.origin===window.location.origin&&(t.preventDefault(),this.pjax.load(e.href).catch((()=>{})))}}}onFormSubmit(t){if(!t.defaultPrevented){var{target:e,submitter:r}=t;if(e instanceof HTMLFormElement){var i=new n(e,r);a(i.getAttribute("target"))===window&&(i=i.getRequestInfo())&&new URL("string"==typeof i?i:i.url).origin===window.location.origin&&(t.preventDefault(),this.pjax.load(i).catch((()=>{})))}}}register(){document.addEventListener("click",(t=>{this.onLinkOpen(t)})),document.addEventListener("keyup",(t=>{"Enter"===t.key&&this.onLinkOpen(t)})),"SubmitEvent"in window&&document.addEventListener("submit",(t=>{this.onFormSubmit(t)}))}}async function c(t,e={}){var r;let i,{selectors:s,switches:n,cache:a,timeout:l}={...this.options,...e},c={},h=(null==(r=this.abortController)?void 0:r.signal)||null;c.signal=h,(t=new Request(t,{cache:a,signal:h})).headers.set("X-Requested-With","Fetch"),t.headers.set("X-Pjax","true"),t.headers.set("X-Pjax-Selectors",JSON.stringify(s)),c.request=t,c.timeout=l,0<l&&(i=window.setTimeout((()=>{var t;null==(t=this.abortController)||t.abort()}),l),c.timeoutID=i),this.fire("send",c);try{let r=await fetch(t).finally((()=>{window.clearTimeout(i)}));c.response=r;let a=new URL(r.url);a.hash=new URL(t.url).hash,window.location.href!==a.href&&window.history.pushState(null,"",a.href);let l=(new DOMParser).parseFromString(await r.text(),"text/html");c.switches=n;let u=await async function(t,{selectors:e,switches:r,signal:i=null}){if(null!=i&&i.aborted)throw new DOMException("Aborted switches","AbortError");let s=!1,n=[];return e.forEach((e=>{let i=t.querySelectorAll(e),a=document.querySelectorAll(e);if(i.length!==a.length)throw new DOMException(`Selector '${e}' does not select the same amount of nodes`,"IndexSizeError");let{activeElement:l}=document;a.forEach(((t,a)=>{!s&&l&&t.contains(l)&&((l instanceof HTMLElement||l instanceof SVGElement)&&l.blur(),s=!0);let c=(null==r?void 0:r[e])||o.default,h=Promise.resolve().then((()=>c(t,i[a]))).catch((()=>{}));n.push(h)}))})),await Promise.race([Promise.all(n),new Promise(((t,e)=>{null==i||i.addEventListener("abort",(()=>{e(new DOMException("Aborted switches","AbortError"))}))}))]),{focusCleared:s}}(l,{selectors:s,switches:n,signal:h});c.switchesResult=u,await this.preparePage(u,e)}catch(t){throw c.error=t,this.fire("error",c),t}finally{this.fire("complete",c)}this.fire("success",c)}let h="application/ecmascript application/javascript application/x-ecmascript application/x-javascript text/ecmascript text/javascript text/javascript1.0 text/javascript1.1 text/javascript1.2 text/javascript1.3 text/javascript1.4 text/javascript1.5 text/jscript text/livescript text/x-ecmascript text/x-javascript".split(" ");class u{constructor(t){if(this.evaluable=this.blocking=this.external=!1,this.target=t,t.hasAttribute("src")||t.text){var e=t.type?t.type.trim():"text/javascript";if(h.includes(e))this.type="classic";else{if("module"!==e)return;this.type="module"}if(!t.noModule||"classic"!==this.type){if(t.hasAttribute("src")){if(!(e=t.getAttribute("src")))return;this.external=!0;try{new URL(e,document.URL)}catch{return}}this.blocking=!0,("classic"!==this.type||this.external&&(t.hasAttribute("async")||t.hasAttribute("defer")))&&(this.blocking=!1),this.evaluable=!0}}}eval(){return new Promise(((t,e)=>{let r=this.target,i=document.createElement("script");i.addEventListener("error",e),r.getAttributeNames().forEach((t=>{i.setAttribute(t,r.getAttribute(t)||"")})),i.text=r.text,this.external&&(i.hasAttribute("async")||(i.async=!1),i.defer=!1),document.contains(r)?r.replaceWith(i):(document.head.append(i),this.external?i.addEventListener("load",(()=>i.remove())):i.remove()),this.external?i.addEventListener("load",(()=>t())):t()}))}}class d{constructor(t){this.signal=t}async exec(t){var e;if(null!=(e=this.signal)&&e.aborted)throw new DOMException("Execution aborted","AbortError");e=t.eval().catch((()=>{})),t.blocking&&await e}}async function w(t,e={}){if(e={...this.options,...e},t){var r;if(t.focusCleared){let t=document.querySelectorAll("[autofocus]")[0];(t instanceof HTMLElement||t instanceof SVGElement)&&t.focus()}let i=[];e.scripts&&document.querySelectorAll(e.scripts).forEach((t=>{t instanceof HTMLScriptElement&&i.push(t)})),e.selectors.forEach((t=>{document.querySelectorAll(t).forEach((t=>{t instanceof HTMLScriptElement?i.push(t):t.querySelectorAll("script").forEach((t=>{i.includes(t)||i.push(t)}))}))})),i.sort(((t,e)=>t.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_PRECEDING||-1)),await async function(t,{signal:e=null}={}){if(null!=e&&e.aborted)throw new DOMException("Aborted execution","AbortError");t=Array.from(t,(t=>new u(t))).filter((t=>t.evaluable));let r=new d(e);t=t.reduce(((t,e)=>e.external?Promise.all([t,r.exec(e)]):t.then((()=>r.exec(e)))),Promise.resolve()),await Promise.race([t,new Promise(((t,r)=>{null==e||e.addEventListener("abort",(()=>{r(new DOMException("Aborted execution","AbortError"))}))}))])}(i,{signal:null==(r=this.abortController)?void 0:r.signal})}({scrollTo:r}=e),!1!==r&&(t=!!t&&[0,0],Array.isArray(r)?t=r:"number"==typeof r?t=[window.scrollX,r]:(r=decodeURIComponent(window.location.hash.slice(1)))&&(r=document.getElementById(r)||document.getElementsByName(r)[0])&&(r.scrollIntoView(),t=!1),t&&window.scrollTo(t[0],t[1]))}async function p(t,e={}){var r;this.storeHistory();var i=new AbortController;null==(r=this.abortController)||r.abort(),this.abortController=i,r=!0,"string"==typeof t&&((i=new URL(t)).pathname+i.search===this.location.pathname+this.location.search&&(window.location.hash!==i.hash&&window.history.pushState(null,"",i.href),await this.preparePage(null,e),r=!1)),r&&await this.switchDOM(t,e),this.history.pull(),this.location.href=window.location.href,this.abortController=null}class f{static reload(){window.location.reload()}constructor(t={}){this.options={defaultTrigger:!0,selectors:["title",".pjax"],switches:{abc:o.default},scripts:"script[data-pjax]",scrollTo:!0,scrollRestoration:!0,cache:"default",timeout:0},this.history=new i("pjax"),this.location=new URL(window.location.href),this.abortController=null,this.switchDOM=c,this.preparePage=w,this.weakLoad=p,Object.assign(this.options,t),this.options.scrollRestoration&&(window.history.scrollRestoration="manual",window.addEventListener("beforeunload",(()=>{window.history.scrollRestoration="auto"}))),this.options.defaultTrigger&&new l(this).register(),window.addEventListener("popstate",(t=>{this.storeHistory(),this.history.pull(),null!==t.state&&(t={},this.options.scrollRestoration&&this.history.state&&(t.scrollTo=this.history.state.scrollPos),this.load(window.location.href,t).catch((()=>{})))}))}storeHistory(){this.history.state={scrollPos:[window.scrollX,window.scrollY]}}fire(t,e){t=new CustomEvent(`pjax:${t}`,{bubbles:!0,cancelable:!1,detail:{abortController:this.abortController,...e}}),document.dispatchEvent(t)}async load(t,e={}){try{await this.weakLoad(t,e)}catch(e){if(e instanceof DOMException&&"AbortError"===e.name)throw e;window.location.assign("string"==typeof t?t:t.url)}}}f.switches=o;const m=f}}]);
//# sourceMappingURL=48.js.map